<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <template id="technical_reports_qweb_document">
            <t t-call="report.external_layout">
                <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})"/>
                <div class="page">
                    <p class="row">
                        <p>Spett. <strong><span t-field="o.partner_id.name"/></strong><br/>
                            <span t-field="o.partner_id.street"></span><br/>
                            <span t-field="o.partner_id.city"></span>
                            <span t-field="o.partner_id.zip"></span><br/>
                            <span t-field="o.partner_id.country_id"></span>
                        </p>
                    </p><br/>
                    <h4><strong>Technical report nÂ° </strong><span t-field="o.name"/></h4><br/>

                    <div class="row">
                        <div class="col-xs-4"><strong>Project: </strong><span t-field="o.project_id.name"/></div>
                        <div class="col-xs-4"><strong>Activity: </strong><span t-field="o.project_activity_id.name"/></div>
                        <div class="col-xs-4"><strong>Order type: </strong><span t-field="o.order_type"/></div>
                    </div>

                    <div class="row">
                        <div class="col-xs-4"><strong>Intervention place: </strong><span t-field="o.intervention_place"/></div>
                        <div class="col-xs-4"><strong>City: </strong><span t-field="o.city"/></div>
                    </div><br/>

                    <div class="row">
                        <div class="col-xs-4"><strong>Start journey: </strong><span t-field="o.start_journey_date"/></div>
                        <div class="col-xs-4"><strong>End journey: </strong><span t-field="o.end_journey_date"/></div>
                        <t t-if="o.end_journey_date">
                            <t t-if="o.start_journey_date">
                                <t t-set="journey" t-value="timediff(o.end_journey_date, o.start_journey_date)"/>
                                <div class="col-xs-4"><strong>Time journey: </strong>
                                    <span t-esc="journey.days"/> days
                                    <span t-esc="journey.seconds/3600"/>:<span t-esc="journey.seconds/60"/>:<span t-esc="journey.seconds"/>
                                </div>
                            </t>
                        </t>
                    </div>

                    <div class="row">
                        <div class="col-xs-4"><strong>Start activity: </strong><span t-field="o.start_activity_date"/></div>
                        <div class="col-xs-4"><strong>End activity: </strong><span t-field="o.end_activity_date"/></div>
                        <t t-if="o.end_activity_date">
                            <t t-if="o.start_activity_date">
                                <t t-set="activity" t-value="timediff(o.end_activity_date, o.start_activity_date)"/>
                                <div class="col-xs-4"><strong>Time activity: </strong>
                                    <span t-esc="activity.days"/> days
                                    <span t-esc="activity.seconds/3600"/>:<span t-esc="activity.seconds/60"/>:<span t-esc="activity.seconds"/>
                                </div>
                            </t>
                        </t>
                    </div><br/><br/><br/>

                    <strong>ACTIVITY</strong>
                    <table class="table table-bordered">
                        <tr><th style="background:grey; color:white;">Description</th></tr>
                        <tr><td><span t-field="o.activity_description"/></td></tr>
                    </table><br/>

                    <div class="notes"><strong>NOTES</strong></div>
                    <table class="table table-bordered" name="notes">
                        <t t-set="count" t-value="0"/>
                        <thead>
                            <tr style="background:grey; color:white;">
                                <th width="65%" style="text-align:center;">Note</th>
                                <th width="25%" style="text-align:center;">Date</th>
                                <th width="10%" style="text-align:center;">Worked</th>
                            </tr>
                        </thead>
                        <t t-foreach="o.notes_ids" t-as="n">
                            <tr>
                                <td width="65%"> <span t-field="n.notes"/> </td>
                                <td width="25%" style="text-align:center;"> <span t-field="n.date_and_hour"/> </td>
                                <td width="10%" style="text-align:center;"><t t-if="n.worked">Yes</t>
                                    <t t-if="n.worked==False">No</t>
                                </td>
                            </tr>
                            <t t-set="count" t-value="count+1"/>
                        </t>
                    </table>
                    <br/>
                    <strong>FORMATION</strong>
                    <table class="table table-bordered">
                        <tr>
                            <th style="background:grey; color:white;">Trainer User</th>
                        </tr>
                        <t t-foreach="o.users_ids" t-as="n">
                           <tr><td><span t-field="n.name"/></td></tr>
                        </t>
                    </table>
                    <br/>
                    <strong>PARTECIPATING CUSTOMERS</strong>
                    <table class="table table-bordered">
                        <tr><th style="background:grey; color:white;">Description</th></tr>
                        <tr><td><span t-field="o.partecipants_customer_description"/></td></tr>
                    </table>
                    <br/>
                    <strong>CUSTOMER NOTES</strong>
                    <table class="table table-bordered">
                        <tr><th style="background:grey; color:white;">Description</th></tr>
                        <tr><td><span t-field="o.customer_note"/></td></tr>
                    </table>
                    <br/>
                    <br/>

                    <div style="text-align:right;height:45px"><strong>SIGNATURE:</strong>
                        <div class="col-xs-12">
                            <!--img t-if="o.digital_sign" t-att-src="'data:image/png;base64,%s' % o.digital_sign"
                                 style="max-height:45px;"/-->
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="technical_reports_qweb">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="technical_reports.technical_reports_qweb_document" t-lang="o.partner_id.lang"/>
                </t>
            </t>
        </template>

    </data>
</odoo>
